var g=(x,c,f)=>new Promise((u,l)=>{var k=s=>{try{i(f.next(s))}catch(y){l(y)}},C=s=>{try{i(f.throw(s))}catch(y){l(y)}},i=s=>s.done?u(s.value):Promise.resolve(s.value).then(k,C);i((f=f.apply(x,c)).next())});import{a as P,c as q,a3 as A,O as K,e as z,ab as H,y as U,n as d,q as e,i as w,a2 as Y,f as M,j as m,l as n,x as o,t as _,k as p,K as v,a5 as I,H as G,F as J,v as Q}from"./frappe-ui-DZDZpt4w.js";import{d as W,I as X,b as Z,c as ee}from"./index-BxNz1Obz.js";import{f as te}from"./formatters-Ch330Bw1.js";import oe from"./ProfileInfoModal-C_tKV1BA.js";import{a as se}from"./notifications-B1BwxtuP.js";import"./FormattedField-Dx2k-jzC.js";import"./EmployeeAvatar-zMm99X4x.js";const ae=x=>g(void 0,null,function*(){yield(yield W.create({header:"Error",message:x,buttons:["OK"]})).present()}),ne={class:"flex flex-col h-screen w-screen"},le={class:"w-full sm:w-96"},re={class:"flex flex-row bg-white shadow-sm py-4 px-3 items-center justify-between border-b sticky top-0 z-10"},ce={class:"flex flex-row items-center"},ie=o("h2",{class:"text-xl font-semibold text-gray-900"},"Profile",-1),de={class:"flex flex-col items-center mt-5 p-4"},me=["src","alt"],fe={key:1,class:"flex items-center justify-center bg-gray-200 uppercase text-gray-600 h-24 w-24 rounded-full object-cover"},ue={class:"flex flex-col gap-1.5 items-center mt-2 mb-5"},_e={key:0,class:"text-lg font-bold text-gray-900"},pe={key:1,class:"font-normal text-sm text-gray-500"},ye={class:"flex flex-col gap-5 my-4 w-full"},ge={class:"flex flex-col bg-white rounded"},he=["onClick"],xe={class:"flex flex-row items-center gap-3 grow"},be={class:"text-base font-normal text-gray-800"},we={key:2,class:"flex flex-col gap-5 my-4 w-full"},ve={class:"flex flex-col bg-white rounded"},ke={class:"flex flex-row items-center gap-3 grow"},Ce=o("div",{class:"text-base font-normal text-gray-800"}," Settings ",-1),h="Employee",Me={__name:"Profile",setup(x){const c=w("$socket"),f=w("$session"),u=w("$user"),l=w("$employee"),k=Y(),C=[{icon:"user",title:"Employee Details",fields:["employee_name","employee_number","gender","date_of_birth","date_of_joining","blood_group"]},{icon:"file",title:"Company Information",fields:["company","department","designation","branch","grade","reports_to","employment_type"]},{icon:"book",title:"Contact Information",fields:["cell_number","personal_email","company_email","preferred_email"]},{icon:"dollar-sign",title:"Salary Information",fields:["ctc","payroll_cost_center","pan_number","provident_fund_account","salary_mode","bank_name","bank_ac_no","ifsc_code","micr_code","iban"]}],i=P(!1),s=P(null),y=q(()=>{var t;return((t=window.frappe)==null?void 0:t.boot.push_relay_server_url)&&se.data}),O=t=>g(this,null,function*(){s.value=t,i.value=!0}),S=t=>g(this,null,function*(){i.value=!1,s.value=null}),j=A({doctype:h,name:l.data.name,fields:"*",auto:!0,transform:t=>(t.ctc=te(t.ctc,t.salary_currency),t)}),V=K({url:"essdee_attendance.api.get_doctype_fields",params:{doctype:h},auto:!0}),F=t=>{const a=V.data.find(b=>b.fieldname===t);return[a==null?void 0:a.label,a==null?void 0:a.fieldtype]},L=()=>g(this,null,function*(){try{yield f.logout.submit()}catch(t){const a="An error occurred while attempting to log out!";console.error(a,t),ae(a)}});return z(()=>{c.emit("doctype_subscribe",h),c.on("list_update",t=>{t.doctype===h&&t.name===l.data.name&&j.reload()})}),H(()=>{c.emit("doctype_unsubscribe",h),c.off("list_update")}),(t,a)=>{const b=M("Button"),R=M("router-link");return m(),U(e(ee),null,{default:d(()=>[n(e(Z),{class:"ion-padding"},{default:d(()=>{var D,$,B,E;return[o("div",ne,[o("div",le,[o("header",re,[o("div",ce,[n(b,{variant:"ghost",class:"!pl-0 hover:bg-white",onClick:a[0]||(a[0]=r=>e(k).back())},{default:d(()=>[n(e(_),{name:"chevron-left",class:"h-5 w-5"})]),_:1}),ie])]),o("div",de,[e(u).data.user_image?(m(),p("img",{key:0,class:"h-24 w-24 rounded-full object-cover",src:e(u).data.user_image,alt:e(u).data.first_name},null,8,me)):(m(),p("div",fe,v(e(u).data.first_name[0]),1)),o("div",ue,[e(l)?(m(),p("span",_e,v(($=(D=e(l))==null?void 0:D.data)==null?void 0:$.employee_name),1)):I("",!0),e(l)?(m(),p("span",pe,v((E=(B=e(l))==null?void 0:B.data)==null?void 0:E.designation),1)):I("",!0)]),o("div",ye,[o("div",ge,[(m(),p(J,null,G(C,r=>o("div",{class:"flex flex-row cursor-pointer flex-start p-4 items-center justify-between border-b",key:r.title,onClick:N=>O(r)},[o("div",xe,[n(e(_),{name:r.icon,class:"h-5 w-5 text-gray-500"},null,8,["name"]),o("div",be,v(r.title),1)]),n(e(_),{name:"chevron-right",class:"h-5 w-5 text-gray-500"})],8,he)),64))])]),y.value?(m(),p("div",we,[o("div",ve,[n(R,{to:{name:"Settings"},class:"flex flex-row cursor-pointer flex-start p-4 items-center justify-between border-b"},{default:d(()=>[o("div",ke,[n(e(_),{name:"settings",class:"h-5 w-5 text-gray-500"}),Ce]),n(e(_),{name:"chevron-right",class:"h-5 w-5 text-gray-500"})]),_:1})])])):I("",!0),n(b,{onClick:L,variant:"outline",theme:"red",class:"w-full shadow py-4 mt-5"},{prefix:d(()=>[n(e(_),{name:"log-out",class:"w-4"})]),default:d(()=>[Q(" Log Out ")]),_:1})])])]),n(e(X),{ref:"modal","is-open":i.value,onDidDismiss:S,"initial-breakpoint":1,breakpoints:[0,1]},{default:d(()=>[n(oe,{title:s.value.title,data:s.value.fields.map(r=>{const[N,T]=F(r);return{fieldname:r,value:e(j).doc[r],label:N,fieldtype:T}})},null,8,["title","data"])]),_:1},8,["is-open"])]}),_:1})]),_:1})}}};export{Me as default};
//# sourceMappingURL=Profile-Ca5XWDLJ.js.map
